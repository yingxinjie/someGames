{"version":3,"sources":["assets\\bundle\\02_game\\script\\config\\deskMgr.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { UserInfo } from \"../../../01_hall/script/config/UserInfo\";\nimport head from \"../head\";\nimport { DeskInfo } from \"./deskInfo\";\nimport { DzUtils } from \"./dzUtils\";\nimport { NodeDZpool, POOLTYPE } from \"./nodeDZpool\";\n\n\nclass deskMgr {\n    private static sing: deskMgr = null\n\n    public static get ins(): deskMgr {\n        if (this.sing == null) {\n            this.sing = new deskMgr();\n        }\n        return this.sing;\n    }\n\n    private convertNum: number\n\n    public convertArr: number[] = [1, 2, 3, 4, 5, 6, 7, 8, 9]\n\n    public convertdataArr: number[] = [1, 2, 3, 4, 5, 6, 7, 8, 9]\n\n    private cardMap = new Map([\n        [0x02 & 0xF, '2'],\n        [0x03 & 0xF, '3'],\n        [0x04 & 0xF, '4'],\n        [0x05 & 0xF, '5'],\n        [0x06 & 0xF, '6'],\n        [0x07 & 0xF, '7'],\n        [0x08 & 0xF, '8'],\n        [0x09 & 0xF, '9'],\n        [0x0A & 0xF, '10'],\n        [0x0B & 0xF, '11'],\n        [0x0C & 0xF, '12'],\n        [0x0D & 0xF, '13'],\n        [0x0E & 0xF, '1']\n    ]);\n\n    /*\n    扑克转换\n    */\n    public async convertPoker(pokerVal) {\n        let spr: cc.SpriteFrame\n        var value = pokerVal & 0xF;\n        var suit = pokerVal >> 4;\n        var suitStr = '♦';//方块\n        if (suit == 1) {\n            suitStr = '♣';//梅花\n        } else if (suit == 2) {\n            suitStr = '♥';//红桃\n        } else if (suit == 3) {\n            suitStr = '♠';//黑桃\n        }\n        // return suitStr + \":\" + this.cardMap.get(value);\n        let url = `card_${suit}_${this.cardMap.get(value)}`\n        console.log(`url: ${url}`)\n        spr = await DzUtils.loadCardPic(url) as cc.SpriteFrame\n        return spr\n    }\n\n\n\n    public setconvertNum(seat: number) {\n        this.convertNum = seat == 1 ? 0 : DeskInfo.seatLen - (seat - 1)\n        console.log(`convertNum: ${this.convertNum}  } `)\n        this.convertArr = []\n        for (let seat = 1; seat <= DeskInfo.seatLen; seat++) {\n            let cNum = this.convertSeat(seat)\n            this.convertArr.push(cNum)\n        }\n        console.log(`convertArr: ${JSON.stringify(this.convertArr)} `)\n    }\n\n    convertSeat(seat: number) {\n        let convertSeat = seat + this.convertNum\n        let _convertSeat = convertSeat > DeskInfo.seatLen ? convertSeat - DeskInfo.seatLen : convertSeat\n        console.log(`tureSeat: ${seat}   convertSeat: ${_convertSeat} `)\n        return _convertSeat\n    }\n\n    TweenSeat(seats: cc.Node[]) {\n        //  let dir = DeskInfo.readyPos < Math.ceil(DeskInfo.seatLen / 2) ? -1 : 1 //0逆时针 1顺时针\n        for (let i = 0; i < DeskInfo.seatLen; i++) {\n            let seat = seats[i]\n            let nextSeat = this.convertArr[i]\n\n            let nextPos = UserInfo.seatPJson[DeskInfo.seatLen][nextSeat - 1]\n            let pos = UserInfo.seatPJson[DeskInfo.seatLen][i]\n            cc.tween(seat).to(0.5, { x: nextPos.x, y: nextPos.y }).call(() => {\n                seat.x = pos.x\n                seat.y = pos.y\n                let nextSeatNode = seats[nextSeat - 1]\n                let _head = seat.children[0]\n                if (_head) {\n                    let ts = _head.getComponent(head)\n                    if (ts.convertseat - 1 == Number(seat.name.slice(-1))) {\n                        _head.parent = nextSeatNode\n                    }\n                }\n\n            }).start()\n\n\n        }\n    }\n\n\n    initSeat(seats: cc.Node[]) {\n        for (let i = 0; i < DeskInfo.seatLen; i++) {\n            let seat = seats[i]\n            let nextSeat = this.convertArr[i]\n            let nextSeatNode = seats[nextSeat - 1]\n            let _head = seat.children[0]\n            if (_head) {\n                let ts = _head.getComponent(head)\n                if (ts.convertseat - 1 == Number(seat.name.slice(-1))) {\n                    _head.parent = nextSeatNode\n                }\n            }\n        }\n    }\n\n\n    addPots(pots: { [player: number]: number }) {\n        let totalpot: number\n        for (let playerId in pots) {\n            let pot = pots[playerId]\n            totalpot += pot\n        }\n        return totalpot\n    }\n\n    async setCard(targetArr: cc.Node[], index: number, value: number) {\n        let _targets = targetArr\n        _targets[index].active = true\n        _targets[index].getChildByName(\"cardbg\").active = true\n        _targets[index].getChildByName(\"card\").getComponent(cc.Sprite).spriteFrame = await DeskMgr.convertPoker(value)\n    }\n\n\n    setLightDir(){\n        \n    }  \n\n\n\n    TweenSendCard(target: cc.Node, callback: Function, parent: any) {\n        let flyCard: cc.Node = NodeDZpool.getObj(POOLTYPE.CARD)\n        flyCard.parent = parent\n        flyCard.x = 0\n        flyCard.y = 0\n        flyCard.scale = 0.5\n        flyCard.opacity = 122\n        let twotaget = target.getChildByName('sprTwoCard')\n        let { x, y } = target.parent\n        cc.Tween.stopAllByTarget(flyCard)\n        cc.tween(flyCard).to(0.3, { x: x + twotaget.x, y: y + twotaget.y, scale: 1, opacity: 255 }).call(() => {\n            callback && callback()\n            NodeDZpool.recovery(POOLTYPE.CARD, flyCard)\n        }).start()\n    }\n\n\n    TweenTurnCard(target: cc.Node, callback: Function) {\n        target.scaleX = 1\n        cc.Tween.stopAllByTarget(target)\n        cc.tween(target).to(0.15, { scaleX: 0.1 }).call(callback).to(0.15, { scaleX: 1 }).start()\n    }\n\n\n    TweenThreeBoard(target: cc.Node, callback: Function) {\n        target.scaleX = 1\n        cc.Tween.stopAllByTarget(target)\n        cc.tween(target).to(0.15, { scaleX: 0.1 }).call(callback).to(0.15, { scaleX: 1 }).start()\n    }\n\n\n\n\n\n\n\n}\n\n/** 桌内管理 */\nexport const DeskMgr = deskMgr.ins;\n\n"]}