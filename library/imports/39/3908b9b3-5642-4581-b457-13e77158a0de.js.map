{"version":3,"sources":["assets\\bundle\\02_game\\script\\config\\deskMgr.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { UserInfo } from \"../../../01_hall/script/config/UserInfo\";\r\nimport head from \"../head\";\r\nimport { DeskInfo } from \"./deskInfo\";\r\nimport { DzUtils } from \"./dzUtils\";\r\nimport { NodeDZpool, POOLTYPE } from \"./nodeDZpool\";\r\n\r\n\r\nclass deskMgr {\r\n    private static sing: deskMgr = null\r\n\r\n    public static get ins(): deskMgr {\r\n        if (this.sing == null) {\r\n            this.sing = new deskMgr();\r\n        }\r\n        return this.sing;\r\n    }\r\n\r\n    private convertNum: number\r\n\r\n    public convertArr: number[] = [1, 2, 3, 4, 5, 6, 7, 8, 9]\r\n\r\n    public convertdataArr: number[] = [1, 2, 3, 4, 5, 6, 7, 8, 9]\r\n\r\n    private cardMap = new Map([\r\n        [0x02 & 0xF, '2'],\r\n        [0x03 & 0xF, '3'],\r\n        [0x04 & 0xF, '4'],\r\n        [0x05 & 0xF, '5'],\r\n        [0x06 & 0xF, '6'],\r\n        [0x07 & 0xF, '7'],\r\n        [0x08 & 0xF, '8'],\r\n        [0x09 & 0xF, '9'],\r\n        [0x0A & 0xF, '10'],\r\n        [0x0B & 0xF, '11'],\r\n        [0x0C & 0xF, '12'],\r\n        [0x0D & 0xF, '13'],\r\n        [0x0E & 0xF, '1']\r\n    ]);\r\n\r\n    /*\r\n    扑克转换\r\n    */\r\n    public async convertPoker(pokerVal) {\r\n        let spr: cc.SpriteFrame\r\n        var value = pokerVal & 0xF;\r\n        var suit = pokerVal >> 4;\r\n        var suitStr = '♦';//方块\r\n        if (suit == 1) {\r\n            suitStr = '♣';//梅花\r\n        } else if (suit == 2) {\r\n            suitStr = '♥';//红桃\r\n        } else if (suit == 3) {\r\n            suitStr = '♠';//黑桃\r\n        }\r\n        // return suitStr + \":\" + this.cardMap.get(value);\r\n        let url = `card_${suit}_${this.cardMap.get(value)}`\r\n        console.log(`url: ${url}`)\r\n        spr = await DzUtils.loadCardPic(url) as cc.SpriteFrame\r\n        return spr\r\n    }\r\n\r\n\r\n\r\n    public setconvertNum(seat: number) {\r\n        this.convertNum = seat == 1 ? 0 : DeskInfo.seatLen - (seat - 1)\r\n        console.log(`convertNum: ${this.convertNum}  } `)\r\n        this.convertArr = []\r\n        for (let seat = 1; seat <= DeskInfo.seatLen; seat++) {\r\n            let cNum = this.convertSeat(seat)\r\n            this.convertArr.push(cNum)\r\n        }\r\n        console.log(`convertArr: ${JSON.stringify(this.convertArr)} `)\r\n    }\r\n\r\n    convertSeat(seat: number) {\r\n        let convertSeat = seat + this.convertNum\r\n        let _convertSeat = convertSeat > DeskInfo.seatLen ? convertSeat - DeskInfo.seatLen : convertSeat\r\n        console.log(`tureSeat: ${seat}   convertSeat: ${_convertSeat} `)\r\n        return _convertSeat\r\n    }\r\n\r\n    TweenSeat(seats: cc.Node[]) {\r\n        //  let dir = DeskInfo.readyPos < Math.ceil(DeskInfo.seatLen / 2) ? -1 : 1 //0逆时针 1顺时针\r\n        for (let i = 0; i < DeskInfo.seatLen; i++) {\r\n            let seat = seats[i]\r\n            let nextSeat = this.convertArr[i]\r\n\r\n            let nextPos = UserInfo.seatPJson[DeskInfo.seatLen][nextSeat - 1]\r\n            let pos = UserInfo.seatPJson[DeskInfo.seatLen][i]\r\n            cc.tween(seat).to(0.5, { x: nextPos.x, y: nextPos.y }).call(() => {\r\n                seat.x = pos.x\r\n                seat.y = pos.y\r\n                let nextSeatNode = seats[nextSeat - 1]\r\n                let _head = seat.children[0]\r\n                if (_head) {\r\n                    let ts = _head.getComponent(head)\r\n                    if (ts.convertseat - 1 == Number(seat.name.slice(-1))) {\r\n                        _head.parent = nextSeatNode\r\n                    }\r\n                }\r\n\r\n            }).start()\r\n\r\n\r\n        }\r\n    }\r\n\r\n\r\n    initSeat(seats: cc.Node[]) {\r\n        for (let i = 0; i < DeskInfo.seatLen; i++) {\r\n            let seat = seats[i]\r\n            let nextSeat = this.convertArr[i]\r\n            let nextSeatNode = seats[nextSeat - 1]\r\n            let _head = seat.children[0]\r\n            if (_head) {\r\n                let ts = _head.getComponent(head)\r\n                if (ts.convertseat - 1 == Number(seat.name.slice(-1))) {\r\n                    _head.parent = nextSeatNode\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    addPots(pots: { [player: number]: number }) {\r\n        let totalpot: number\r\n        for (let playerId in pots) {\r\n            let pot = pots[playerId]\r\n            totalpot += pot\r\n        }\r\n        return totalpot\r\n    }\r\n\r\n\r\n\r\n    TweenSendCard(target: cc.Node, callback: Function, parent: any) {\r\n        let flyCard: cc.Node = NodeDZpool.getObj(POOLTYPE.CARD)\r\n        flyCard.parent = parent\r\n        flyCard.x = 0\r\n        flyCard.y = 0\r\n        flyCard.scale = 0.5\r\n        flyCard.opacity = 122\r\n        let twotaget = target.getChildByName('sprTwoCard')\r\n        let { x, y } = target.parent\r\n        cc.tween(flyCard).to(0.3, { x: x + twotaget.x, y: y + twotaget.y, scale: 1, opacity: 255 }).call(() => {\r\n            callback && callback()\r\n            NodeDZpool.recovery(POOLTYPE.CARD, flyCard)\r\n        }).start()\r\n    }\r\n\r\n\r\n    TweenTurnCard(target: cc.Node) {\r\n       //cc.tween(target).flipY().start()\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n}\r\n\r\n/** 桌内管理 */\r\nexport const DeskMgr = deskMgr.ins;\r\n\r\n"]}