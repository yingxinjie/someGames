{"version":3,"sources":["assets\\bundle\\01_hall\\script\\config\\ViewManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { bundleLoader } from \"../../../../script/bundleLoader\";\r\nimport { ViewEnum, WidgetEnum } from \"./config\";\r\n\r\nclass viewManager {\r\n    private static single: viewManager;\r\n    public static get ins(): viewManager { if (this.single == null) { this.single = new viewManager(); } return this.single; }\r\n\r\n    public init() {\r\n\r\n    }\r\n\r\n    public Open(view: string, bundleIndex: string = bundleLoader.ENUM_BUNDLE.HALL) {\r\n        return new Promise((resolve, reject) => {\r\n            let bundle = bundleLoader.ENUM_BUNDLE_SAVE[bundleIndex];\r\n            bundle.load('prefab/view/' + view, cc.Prefab, (err: Error, prefab: cc.Prefab) => {\r\n                if (err) {\r\n                    cc.error(\"加载预制体错误\", err);\r\n                    reject(\"error\");\r\n                    return;\r\n                }\r\n\r\n                let node = cc.instantiate(prefab);\r\n                resolve(node);\r\n\r\n                let canvas = cc.director.getScene().getComponentInChildren(cc.Canvas);\r\n                if (!canvas) {\r\n                    cc.error(\"场景中无法找到 canvas 节点,无法显示任何界面\")\r\n                    return;\r\n                }\r\n\r\n                let view = canvas.node.getChildByName(\"view\");\r\n                if (view) {\r\n                    view.children.forEach((child: cc.Node) => { child.destroy(); });\r\n                    view.addChild(node);\r\n                } else { cc.error('hall场景不存在 view 的节点,无法显示预制体'); }\r\n            });\r\n        });\r\n    }\r\n\r\n    public Alert(view: string ,cb?: (node: cc.Node) => void, bundleIndex: string = bundleLoader.ENUM_BUNDLE.HALL) {\r\n        console.log(\"打开界面\", view)\r\n        return new Promise((resolve, reject) => {\r\n            let bundle = bundleLoader.ENUM_BUNDLE_SAVE[bundleIndex];\r\n            bundle.load('prefab/widget/' + view, cc.Prefab, (err: Error, prefab: cc.Prefab) => {\r\n                if (err) {\r\n                    cc.error(\"加载预制体错误\", err);\r\n                    reject(\"error\");\r\n                    return;\r\n                }\r\n\r\n                let node = cc.instantiate(prefab);\r\n                resolve(node);\r\n\r\n                let canvas = cc.director.getScene().getComponentInChildren(cc.Canvas);\r\n                if (!canvas) {\r\n                    cc.error(\"场景中无法找到 canvas 节点,无法显示任何界面\")\r\n                    return;\r\n                }\r\n\r\n                let view = canvas.node.getChildByName(\"widget\");\r\n                if (view) {\r\n                    view.addChild(node);\r\n                    cb && cb(node);\r\n                } else {\r\n                    cc.error('hall场景不存在 view 的节点,无法显示预制体');\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    public RemoveAllView() {\r\n        let canvas = cc.director.getScene().getComponentInChildren(cc.Canvas);\r\n        if (!canvas) {\r\n            cc.error(\"场景中无法找到 canvas 节点,无法显示任何界面\")\r\n            return;\r\n        }\r\n\r\n        let view = canvas.node.getChildByName(\"view\");\r\n        if (view) {\r\n            view.children.forEach((child: cc.Node) => {\r\n                child.destroy();\r\n            });\r\n\r\n        } else {\r\n            cc.error('hall场景不存在 view 的节点,无法显示预制体');\r\n        }\r\n\r\n        let widget = canvas.node.getChildByName(\"widget\");\r\n        if (widget) {\r\n            widget.children.forEach((child: cc.Node) => {\r\n                child.destroy();\r\n            });\r\n        } else {\r\n            cc.error('hall场景不存在 view 的节点,无法显示预制体');\r\n        }\r\n    }\r\n\r\n    public RemoveAlert(alertName: string) {\r\n        let canvas = cc.director.getScene().getComponentInChildren(cc.Canvas);\r\n        if (!canvas) {\r\n            cc.error(\"场景中无法找到 canvas 节点,无法显示任何界面\")\r\n            return;\r\n        }\r\n\r\n        let widget = canvas.node.getChildByName(\"widget\");\r\n        if (widget) {\r\n            widget.children.forEach((child: cc.Node) => {\r\n                if (child.name == alertName) {\r\n                    child.destroy()\r\n                }\r\n            });\r\n        } else {\r\n            cc.error('hall场景不存在 view 的节点,无法显示预制体');\r\n        }\r\n    }\r\n\r\n}\r\n\r\nexport const ViewManager = viewManager.ins;"]}